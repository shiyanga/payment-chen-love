<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.payment.mapper.bnbordermapper.OrderTaskDao">
    <resultMap id="BaseResultMap" type="com.payment.entity.bnborder.OrderTaskEntity">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="orderId" jdbcType="BIGINT" property="orderId"/>
        <result column="busiTransNo" jdbcType="VARCHAR" property="busiTransNo"/>
        <result column="statusId" jdbcType="SMALLINT" property="statusId"/>
        <result column="jobId" jdbcType="VARCHAR" property="jobId"/>
        <result column="jobType" jdbcType="SMALLINT" property="jobType"/>
        <result column="retries" jdbcType="SMALLINT" property="retries"/>
        <result column="createdTime" jdbcType="TIMESTAMP" property="createdTime"/>
        <result column="dataChange_lastTime" jdbcType="TIMESTAMP" property="dataChange_lastTime"/>

        <result column="limit" jdbcType="INTEGER" property="limit"/>

    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        id, orderId, busiTransNo, statusId, jobId, jobType, retries, createdTime, dataChange_lastTime
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List"/>
        from order_task
        where id = #{id,jdbcType=BIGINT}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from order_task
        where id = #{id,jdbcType=BIGINT}
    </delete>
    <insert id="insert" parameterType="com.payment.entity.bnborder.OrderTaskEntity">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into order_task (id, orderId, busiTransNo,
        statusId, jobId, jobType,
        retries, createdTime, dataChange_lastTime
        )
        values (#{id,jdbcType=BIGINT}, #{orderId,jdbcType=BIGINT}, #{busiTransNo,jdbcType=VARCHAR},
        #{statusId,jdbcType=SMALLINT}, #{jobId,jdbcType=VARCHAR}, #{jobType,jdbcType=SMALLINT},
        #{retries,jdbcType=SMALLINT}, #{createdTime,jdbcType=TIMESTAMP}, #{dataChange_lastTime,jdbcType=TIMESTAMP}
        )
    </insert>
    <insert id="insertSelective" parameterType="com.payment.entity.bnborder.OrderTaskEntity">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into order_task
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="orderId != null">
                orderId,
            </if>
            <if test="busiTransNo != null">
                busiTransNo,
            </if>
            <if test="statusId != null">
                statusId,
            </if>
            <if test="jobId != null">
                jobId,
            </if>
            <if test="jobType != null">
                jobType,
            </if>
            <if test="retries != null">
                retries,
            </if>
            <if test="createdTime != null">
                createdTime,
            </if>
            <if test="dataChange_lastTime != null">
                dataChange_lastTime,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=BIGINT},
            </if>
            <if test="orderId != null">
                #{orderId,jdbcType=BIGINT},
            </if>
            <if test="busiTransNo != null">
                #{busiTransNo,jdbcType=VARCHAR},
            </if>
            <if test="statusId != null">
                #{statusId,jdbcType=SMALLINT},
            </if>
            <if test="jobId != null">
                #{jobId,jdbcType=VARCHAR},
            </if>
            <if test="jobType != null">
                #{jobType,jdbcType=SMALLINT},
            </if>
            <if test="retries != null">
                #{retries,jdbcType=SMALLINT},
            </if>
            <if test="createdTime != null">
                #{createdTime,jdbcType=TIMESTAMP},
            </if>
            <if test="dataChange_lastTime != null">
                #{dataChange_lastTime,jdbcType=TIMESTAMP},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.payment.entity.bnborder.OrderTaskEntity">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update order_task
        <set>
            <if test="orderId != null">
                orderId = #{orderId,jdbcType=BIGINT},
            </if>
            <if test="busiTransNo != null">
                busiTransNo = #{busiTransNo,jdbcType=VARCHAR},
            </if>
            <if test="statusId != null">
                statusId = #{statusId,jdbcType=SMALLINT},
            </if>
            <if test="jobId != null">
                jobId = #{jobId,jdbcType=VARCHAR},
            </if>
            <if test="jobType != null">
                jobType = #{jobType,jdbcType=SMALLINT},
            </if>
            <if test="retries != null">
                retries = #{retries,jdbcType=SMALLINT},
            </if>
            <if test="createdTime != null">
                createdTime = #{createdTime,jdbcType=TIMESTAMP},
            </if>
            <if test="dataChange_lastTime != null">
                dataChange_lastTime = #{dataChange_lastTime,jdbcType=TIMESTAMP},
            </if>
        </set>
        WHERE statusid=1

        and jobType in
        <foreach item="item" index="index" collection="listJobType"
                 open="(" separator="," close=")">
            #{item}
        </foreach>

        ORDER BY dataChange_lastTime ASC
        <if test="limit != null">
            limit #{limit,jdbcType=INTEGER}
        </if>

    </update>
    <update id="updateByPrimaryKey" parameterType="com.payment.entity.bnborder.OrderTaskEntity">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update order_task
        set orderId = #{orderId,jdbcType=BIGINT},
        busiTransNo = #{busiTransNo,jdbcType=VARCHAR},
        statusId = #{statusId,jdbcType=SMALLINT},
        jobId = #{jobId,jdbcType=VARCHAR},
        jobType = #{jobType,jdbcType=SMALLINT},
        retries = #{retries,jdbcType=SMALLINT},
        createdTime = #{createdTime,jdbcType=TIMESTAMP},
        dataChange_lastTime = #{dataChange_lastTime,jdbcType=TIMESTAMP}
        where id = #{id,jdbcType=BIGINT}
    </update>


    <update id="updateCompensateTask">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        UPDATE order_task SET statusId=1
        WHERE statusId=2 AND dataChange_lastTime <![CDATA[ < ]]> #{datachangeLasttime}
    </update>


    <select id="selectList" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List"/>
        FROM order_task WHERE jobId=#{jobId,jdbcType=VARCHAR} AND statusid=#{statusId,jdbcType=INTEGER}
        and jobType in
        <foreach item="item" index="index" collection="jobType"
                 open="(" separator="," close=")">
            #{item}
        </foreach>
        ORDER BY dataChange_lastTime ASC
        <if test="limit != null">
            limit #{limit,jdbcType=INTEGER}
        </if>


    </select>


</mapper>